# Text2SQL ì˜¤í”„ë¼ì¸ íŒŒì´í”„ë¼ì¸ TDD êµ¬í˜„ ê³„íš

> **ì‘ì„±ì¼**: 2026-01-08
> **ëª©í‘œ**: ì˜¤í”„ë¼ì¸ íŒŒì´í”„ë¼ì¸ MVP êµ¬í˜„ (Phase 1)
> **ë°©ë²•ë¡ **: TDD (Red â†’ Green â†’ Refactor)

---

## ğŸ“‹ í…ŒìŠ¤íŠ¸ ì§„í–‰ ìƒí™©

### Phase 1-A: í”„ë¡œì íŠ¸ ê¸°ë°˜ êµ¬ì¡° (Week 1-2)

#### 1. í”„ë¡œì íŠ¸ ì´ˆê¸°í™”
- [x] 1.1 í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„± ë° pyproject.toml ì„¤ì •
- [x] 1.2 pytest ì„¤ì • ë° ì²« ë²ˆì§¸ ìŠ¤ëª¨í¬ í…ŒìŠ¤íŠ¸

#### 2. Core ëª¨ë“ˆ - ë°ì´í„° ëª¨ë¸ (`core/models.py`)
- [x] 2.1 `RawSQLLog` ë°ì´í„°í´ë˜ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸
- [x] 2.2 `NormalizedSQL` ë°ì´í„°í´ë˜ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸
- [x] 2.3 `SQLTemplate` ë°ì´í„°í´ë˜ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸
- [x] 2.4 `SQLOperation` Enum ì •ì˜ í…ŒìŠ¤íŠ¸

#### 3. Core ëª¨ë“ˆ - ì„¤ì • (`core/config.py`)
- [x] 3.1 `Settings` Pydantic ëª¨ë¸ ìƒì„± í…ŒìŠ¤íŠ¸
- [x] 3.2 í™˜ê²½ë³€ìˆ˜ì—ì„œ ì„¤ì • ë¡œë“œ í…ŒìŠ¤íŠ¸
- [x] 3.3 ê¸°ë³¸ê°’ ì ìš© í…ŒìŠ¤íŠ¸

---

### Phase 1-B: SQL ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ (Week 3-4)

#### 4. SQL ì •ê·œí™” (`offline/processor/sql_normalizer.py`)
- [x] 4.1 ë¬¸ìì—´ ë¦¬í„°ëŸ´ì„ placeholderë¡œ ì¹˜í™˜ í…ŒìŠ¤íŠ¸
- [x] 4.2 ìˆ«ì ë¦¬í„°ëŸ´ì„ placeholderë¡œ ì¹˜í™˜ í…ŒìŠ¤íŠ¸
- [x] 4.3 ë‚ ì§œ ë¦¬í„°ëŸ´ì„ placeholderë¡œ ì¹˜í™˜ í…ŒìŠ¤íŠ¸
- [x] 4.4 IN ì ˆì˜ ë‹¤ì¤‘ ê°’ placeholder ì¹˜í™˜ í…ŒìŠ¤íŠ¸
- [x] 4.5 ì´ë¯¸ placeholderê°€ ìˆëŠ” SQLì€ ë³€ê²½í•˜ì§€ ì•ŠìŒ í…ŒìŠ¤íŠ¸
- [x] 4.6 í…Œì´ë¸”ëª… ì¶”ì¶œ í…ŒìŠ¤íŠ¸ (ë‹¨ì¼ í…Œì´ë¸”)
- [x] 4.7 í…Œì´ë¸”ëª… ì¶”ì¶œ í…ŒìŠ¤íŠ¸ (JOIN í¬í•¨)
- [x] 4.8 í…Œì´ë¸”ëª… ì¶”ì¶œ í…ŒìŠ¤íŠ¸ (ì„œë¸Œì¿¼ë¦¬ í¬í•¨)
- [x] 4.9 ì»¬ëŸ¼ëª… ì¶”ì¶œ í…ŒìŠ¤íŠ¸ (SELECT ì ˆ)
- [x] 4.10 ì»¬ëŸ¼ëª… ì¶”ì¶œ í…ŒìŠ¤íŠ¸ (WHERE ì ˆ)
- [x] 4.11 UNION ALL íŒ¨í„´ í…Œì´ë¸” ì¶”ì¶œ í…ŒìŠ¤íŠ¸

#### 5. ë¡œê·¸ í•„í„°ë§ (`offline/ingestor/log_filter.py`)
- [x] 5.1 error_count > 0ì¸ ë¡œê·¸ ì œì™¸ í…ŒìŠ¤íŠ¸
- [x] 5.2 DDL ì¿¼ë¦¬ ì œì™¸ í…ŒìŠ¤íŠ¸ (CREATE, ALTER, DROP)
- [x] 5.3 DML ì¿¼ë¦¬ ì œì™¸ í…ŒìŠ¤íŠ¸ (INSERT, UPDATE, DELETE)
- [x] 5.4 SELECT ì¿¼ë¦¬ë§Œ í†µê³¼ í…ŒìŠ¤íŠ¸
- [x] 5.5 exec_count ê¸°ì¤€ TOP-N ìš°ì„ ìˆœìœ„ ì„ ì • í…ŒìŠ¤íŠ¸
- [x] 5.6 ë°°ì¹˜ì„± íŒ¨í„´ ì œì™¸ í…ŒìŠ¤íŠ¸
- [x] 5.7 ì§‘ê³„ í•¨ìˆ˜ í¬í•¨ ì¿¼ë¦¬ ìš°ì„  ì„ ì • í…ŒìŠ¤íŠ¸

---

### Phase 1-C: ì–´ëŒ‘í„° ë ˆì´ì–´ (Week 5)

#### 6. Oracle ì–´ëŒ‘í„° (`adapters/database/oracle_adapter.py`)
- [x] 6.1 ì—°ê²° ìƒì„± í…ŒìŠ¤íŠ¸ (Mock)
- [x] 6.2 SELECT ì¿¼ë¦¬ ì‹¤í–‰ í…ŒìŠ¤íŠ¸ (Mock)
- [x] 6.3 ì—°ê²° í’€ ê´€ë¦¬ í…ŒìŠ¤íŠ¸ (Mock)
- [x] 6.4 ì¿¼ë¦¬ íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸

#### 7. Milvus ì–´ëŒ‘í„° (`adapters/vector_store/milvus_adapter.py`)
- [x] 7.1 ì»¬ë ‰ì…˜ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ í…ŒìŠ¤íŠ¸ (Mock)
- [x] 7.2 ë²¡í„° ì‚½ì… í…ŒìŠ¤íŠ¸ (Mock)
- [x] 7.3 ìœ ì‚¬ë„ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ (Mock)
- [x] 7.4 ë²¡í„° ì‚­ì œ í…ŒìŠ¤íŠ¸ (Mock)

#### 8. Elasticsearch ì–´ëŒ‘í„° (`adapters/search/es_adapter.py`)
- [x] 8.1 ì¸ë±ìŠ¤ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ í…ŒìŠ¤íŠ¸ (Mock)
- [x] 8.2 ë¬¸ì„œ ì‚½ì… í…ŒìŠ¤íŠ¸ (Mock)
- [x] 8.3 BM25 ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ (Mock)
- [x] 8.4 bulk ì‚½ì… í…ŒìŠ¤íŠ¸ (Mock)

---

### Phase 1-D: LLM í†µí•© (Week 6)

#### 9. LLM í´ë¼ì´ì–¸íŠ¸ (`adapters/llm/openai_client.py`)
- [x] 9.1 ChatOpenAI ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸
- [x] 9.2 ë©”ì‹œì§€ ì „ì†¡ ë° ì‘ë‹µ ìˆ˜ì‹  í…ŒìŠ¤íŠ¸ (Mock)
- [x] 9.3 ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ í…ŒìŠ¤íŠ¸ (Mock)
- [x] 9.4 ì—ëŸ¬ í•¸ë“¤ë§ í…ŒìŠ¤íŠ¸ (Rate limit, Timeout)

#### 10. ì„¤ëª… ìƒì„±ê¸° (`offline/processor/description_generator.py`)
- [x] 10.1 ë‹¨ì¼ SQL ì„¤ëª… ìƒì„± í…ŒìŠ¤íŠ¸ (Mock LLM)
- [x] 10.2 ë°°ì¹˜ SQL ì„¤ëª… ìƒì„± í…ŒìŠ¤íŠ¸ (Mock LLM)
- [x] 10.3 í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì ìš© í…ŒìŠ¤íŠ¸
- [x] 10.4 í…Œì´ë¸”/ì»¬ëŸ¼ ì •ë³´ í¬í•¨ í”„ë¡¬í”„íŠ¸ í…ŒìŠ¤íŠ¸

#### 11. ì„ë² ë”© ì„œë¹„ìŠ¤ (`offline/indexer/embedding_service.py`)
- [x] 11.1 ë‹¨ì¼ í…ìŠ¤íŠ¸ ì„ë² ë”© í…ŒìŠ¤íŠ¸ (Mock)
- [x] 11.2 ë°°ì¹˜ í…ìŠ¤íŠ¸ ì„ë² ë”© í…ŒìŠ¤íŠ¸ (Mock)
- [x] 11.3 ì„ë² ë”© ì°¨ì› ê²€ì¦ í…ŒìŠ¤íŠ¸

---

### Phase 1-E: ì¸ë±ì‹± ë° íŒŒì´í”„ë¼ì¸ í†µí•© (Week 7)

#### 12. ë²¡í„° ì¸ë±ì„œ (`offline/indexer/vector_indexer.py`)
- [x] 12.1 SQLTemplate â†’ ì„ë² ë”© + Milvus ì €ì¥ í…ŒìŠ¤íŠ¸
- [x] 12.2 ë°°ì¹˜ ì¸ë±ì‹± í…ŒìŠ¤íŠ¸
- [x] 12.3 ì¤‘ë³µ í…œí”Œë¦¿ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸

#### 13. ES ì¸ë±ì„œ (`offline/indexer/es_indexer.py`)
- [x] 13.1 SQLTemplate â†’ ES ë¬¸ì„œ ì €ì¥ í…ŒìŠ¤íŠ¸
- [x] 13.2 ë°°ì¹˜ ì¸ë±ì‹± í…ŒìŠ¤íŠ¸
- [x] 13.3 ì¸ë±ìŠ¤ ë§¤í•‘ ì„¤ì • í…ŒìŠ¤íŠ¸

#### 14. ë¡œê·¸ ìˆ˜ì§‘ê¸° (`offline/ingestor/log_collector.py`)
- [x] 14.1 IPA í…Œì´ë¸”ì—ì„œ ë¡œê·¸ ì¡°íšŒ í…ŒìŠ¤íŠ¸ (Mock)
- [x] 14.2 ë‚ ì§œ ë²”ìœ„ í•„í„°ë§ í…ŒìŠ¤íŠ¸
- [x] 14.3 limit ì ìš© í…ŒìŠ¤íŠ¸

#### 15. íŒŒì´í”„ë¼ì¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° (`offline/pipeline.py`)
- [x] 15.1 ì „ì²´ íŒŒì´í”„ë¼ì¸ í†µí•© í…ŒìŠ¤íŠ¸ (Mock ì˜ì¡´ì„±)
- [x] 15.2 ìˆ˜ì§‘ â†’ í•„í„°ë§ â†’ ì •ê·œí™” í”Œë¡œìš° í…ŒìŠ¤íŠ¸
- [x] 15.3 ì •ê·œí™” â†’ ì„¤ëª…ìƒì„± â†’ ì¸ë±ì‹± í”Œë¡œìš° í…ŒìŠ¤íŠ¸
- [x] 15.4 ì—ëŸ¬ ì‹œ ë¡¤ë°±/ì¬ì‹œë„ í…ŒìŠ¤íŠ¸
- [x] 15.5 íŒŒì´í”„ë¼ì¸ ê²°ê³¼ ë¦¬í¬íŠ¸ í…ŒìŠ¤íŠ¸

---

### Phase 1-F: ìŠ¤í‚¤ë§ˆ ì§€ì‹ ë¹Œë” (Week 8)

#### 16. ìŠ¤í‚¤ë§ˆ ë¹Œë” (`offline/schema/schema_builder.py`)
- [x] 16.1 Oracleì—ì„œ í…Œì´ë¸” ë©”íƒ€ë°ì´í„° ì¡°íšŒ í…ŒìŠ¤íŠ¸
- [x] 16.2 Oracleì—ì„œ ì»¬ëŸ¼ ë©”íƒ€ë°ì´í„° ì¡°íšŒ í…ŒìŠ¤íŠ¸
- [x] 16.3 í…Œì´ë¸” ì½”ë©˜íŠ¸ ì¶”ì¶œ í…ŒìŠ¤íŠ¸
- [x] 16.4 ì»¬ëŸ¼ ì½”ë©˜íŠ¸ ì¶”ì¶œ í…ŒìŠ¤íŠ¸

#### 17. ìš©ì–´ ì‚¬ì „ ë¹Œë” (`offline/schema/glossary_builder.py`)
- [x] 17.1 CSV ë‹¨ì–´ì‚¬ì „ íŒŒì‹± í…ŒìŠ¤íŠ¸
- [x] 17.2 GlossaryTerm ìƒì„± í…ŒìŠ¤íŠ¸
- [x] 17.3 ES ì¸ë±ì‹± í…ŒìŠ¤íŠ¸

---

## ğŸ—ï¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
src/text2sql/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py
â”‚   â”œâ”€â”€ models.py
â”‚   â””â”€â”€ exceptions.py
â”œâ”€â”€ offline/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ pipeline.py
â”‚   â”œâ”€â”€ ingestor/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ log_collector.py
â”‚   â”‚   â””â”€â”€ log_filter.py
â”‚   â”œâ”€â”€ processor/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ sql_normalizer.py
â”‚   â”‚   â””â”€â”€ description_generator.py
â”‚   â”œâ”€â”€ indexer/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ embedding_service.py
â”‚   â”‚   â”œâ”€â”€ vector_indexer.py
â”‚   â”‚   â””â”€â”€ es_indexer.py
â”‚   â””â”€â”€ schema/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ schema_builder.py
â”‚       â””â”€â”€ glossary_builder.py
â””â”€â”€ adapters/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ database/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â””â”€â”€ oracle_adapter.py
    â”œâ”€â”€ vector_store/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â””â”€â”€ milvus_adapter.py
    â”œâ”€â”€ search/
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â””â”€â”€ es_adapter.py
    â””â”€â”€ llm/
        â”œâ”€â”€ __init__.py
        â””â”€â”€ openai_client.py

tests/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ conftest.py
â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ test_models.py
â”‚   â”‚   â””â”€â”€ test_config.py
â”‚   â”œâ”€â”€ offline/
â”‚   â”‚   â”œâ”€â”€ ingestor/
â”‚   â”‚   â”‚   â”œâ”€â”€ test_log_collector.py
â”‚   â”‚   â”‚   â””â”€â”€ test_log_filter.py
â”‚   â”‚   â”œâ”€â”€ processor/
â”‚   â”‚   â”‚   â”œâ”€â”€ test_sql_normalizer.py
â”‚   â”‚   â”‚   â””â”€â”€ test_description_generator.py
â”‚   â”‚   â”œâ”€â”€ indexer/
â”‚   â”‚   â”‚   â”œâ”€â”€ test_embedding_service.py
â”‚   â”‚   â”‚   â”œâ”€â”€ test_vector_indexer.py
â”‚   â”‚   â”‚   â””â”€â”€ test_es_indexer.py
â”‚   â”‚   â””â”€â”€ schema/
â”‚   â”‚       â”œâ”€â”€ test_schema_builder.py
â”‚   â”‚       â””â”€â”€ test_glossary_builder.py
â”‚   â””â”€â”€ adapters/
â”‚       â”œâ”€â”€ test_oracle_adapter.py
â”‚       â”œâ”€â”€ test_milvus_adapter.py
â”‚       â”œâ”€â”€ test_es_adapter.py
â”‚       â””â”€â”€ test_openai_client.py
â””â”€â”€ integration/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ test_pipeline.py
```

---

## ğŸ“Œ TDD ê·œì¹™

### Red â†’ Green â†’ Refactor ì‚¬ì´í´

1. **Red**: ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ í•˜ë‚˜ ì‘ì„±
2. **Green**: í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ëŠ” ìµœì†Œ ì½”ë“œ ì‘ì„±
3. **Refactor**: ì½”ë“œ ì •ë¦¬ (í…ŒìŠ¤íŠ¸ëŠ” ê³„ì† í†µê³¼í•´ì•¼ í•¨)

### ì»¤ë°‹ ê·œì¹™

- **êµ¬ì¡°ì  ë³€ê²½** (Structural): `refactor: <ì„¤ëª…>`
- **ë™ì‘ ë³€ê²½** (Behavioral): `feat: <ì„¤ëª…>` ë˜ëŠ” `fix: <ì„¤ëª…>`
- **í…ŒìŠ¤íŠ¸ ì¶”ê°€**: `test: <ì„¤ëª…>`

### í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
# ì „ì²´ í…ŒìŠ¤íŠ¸
pytest tests/ -v

# íŠ¹ì • ëª¨ë“ˆ í…ŒìŠ¤íŠ¸
pytest tests/unit/offline/processor/test_sql_normalizer.py -v

# ì»¤ë²„ë¦¬ì§€ í¬í•¨
pytest tests/ -v --cov=src/text2sql --cov-report=html
```

---

## ğŸš€ ì‹œì‘í•˜ê¸°

1. `go` ëª…ë ¹ ì‹œ plan.mdì˜ ë‹¤ìŒ ë¯¸ì™„ë£Œ í…ŒìŠ¤íŠ¸(`[ ]`)ë¥¼ ì°¾ì•„ êµ¬í˜„
2. í…ŒìŠ¤íŠ¸ ì‘ì„± â†’ ì‹¤íŒ¨ í™•ì¸ â†’ ìµœì†Œ êµ¬í˜„ â†’ í†µê³¼ í™•ì¸ â†’ ë¦¬íŒ©í† ë§
3. ì™„ë£Œëœ í…ŒìŠ¤íŠ¸ëŠ” `[x]`ë¡œ í‘œì‹œ
4. ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ í›„ ì»¤ë°‹

